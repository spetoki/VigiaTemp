rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Permite que qualquer pessoa leia a coleção 'sensors' de todos os usuários.
    // Isso é NECESSÁRIO para a API do sensor encontrar o dispositivo pelo MAC address.
    match /users/{userId}/sensors/{sensorId} {
      allow read: if true;
    }

    // Permite que o aplicativo e a API façam qualquer outra operação
    // (escrever temperaturas, ler alertas, etc.) dentro do caminho de um usuário.
    match /users/{accessKey}/{documents=**} {
      allow read, write: if true;
    }
  }
}
